<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />


    <!-- Leaflet Karte -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      defer
    ></script>

    <!-- Font -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap"
      rel="stylesheet"
    />

    <!-- Globale Variablen -->
    <link rel="stylesheet" href="./assets/css/global.css" />

    <!-- Basic CSS -->
    <link rel="stylesheet" href="./assets/css/index.css" />
    <link rel="stylesheet" href="./assets/css/gallery.css">

    <!-- Session Management -->
    <script src="./assets/js/session.js" defer></script>
    
    <!-- Karten JavaScript -->
    <!-- <script src="./assets/js/fullscreen.js" defer></script> -->
    <script src="./assets/js/index.js" defer></script>
    <script src="./assets/js/gallery.js" defer></script>
  </head>
  <body>
    <header id="homepage_header">
      <div id="homepage_header_spotlas">
        <a href="./index.html"
          ><img src="./assets/images/logo_schwarz.png" width="180" alt=""
        /></a>
      </div>

      <div id="homepage_header_ImageItems">
        <div>
          <a href="./pages/add_place/add.html"
            ><img
              src="./assets/images/icons/add_icon.svg"
              alt="add"
              width="40px"
              height="40px"
          /></a>
        </div>
        <div>
          <a href="./pages/profile/profile.html"
            ><img
              src="./assets/images/icons/profile_icon.svg"
              alt="profile"
              width="40px"
              height="40px"
          /></a>
        </div>
        <div>
          <img
            id="toggleImg"
            onclick="showDropdown()"
            src="./assets/images/icons/arrow_icon.svg"
            alt="options"
            width="40px"
            height="40px"
          />
          <div style="display: none; z-index: 12" id="dropDown_menu">
            <a href="./pages/settings/settings.html">Settings</a>
            <a href="./pages/profile/profile.html">Profile</a>
            <a href="./pages/helpCenter/helpcenter.html">Help Center</a>
            <a href="./pages/login_register/login.html">Login</a>
            <a href="./pages/login_register/login.html">Logout</a>
          </div>
        </div>
      </div>
    </header>

    <section id="homepage_section_filter">
      <div id="homepage_filter_search">
        <input
          type="text"
          name="search_filter"
          id="homepage_filter_search_input"
          placeholder="Search..."
        />
      </div>

      <div id="homepage_filters">
        <div
          onclick="fetchLocationsByCategory('Restaurants'), event.stopPropagation();"
          class="homepage_filter"
        >
          <img src="./assets/images/icons/filter/Restaurants.svg" alt="" />
          <h2>Restaurants</h2>
        </div>
        <div
          onclick="fetchLocationsByCategory('Natur')"
          class="homepage_filter"
        >
          <img src="./assets/images/icons/filter/Natur.svg" alt="" />
          <h2>Nature</h2>
        </div>
        <div onclick="" class="homepage_filter">
          <img src="./assets/images/icons/filter/rating.svg" alt="" />
          <h2>Rating</h2>
        </div>
        <div
          onclick="fetchLocationsByCategory('Hotels')"
          class="homepage_filter"
        >
          <img src="./assets/images/icons/filter/Hotels.svg" alt="" />
          <h2>Stays</h2>
        </div>
        <div
          onclick="fetchLocationsByCategory('Sehenswürdigkeiten')"
          class="homepage_filter"
        >
          <img src="./assets/images/icons/filter/Sehenswürdigkeiten.svg" alt="" />
          <h2>Sights</h2>
        </div>
        <div
          onclick="fetchLocationsByCategory('Museen')"
          class="homepage_filter"
        >
          <img src="./assets/images/icons/filter/Museen.svg" alt="" />
          <h2>Museums</h2>
        </div>

        <div onclick="fetchAllLocations()" class="homepage_filter">
          <img src="./assets/images/icons/delete.svg" alt="" />
          <h2>Delete Filters</h2>
        </div>
      </div>
    </section>

    <div id="homepage_karte_sidebar"></div>
    <div id="map"></div>

    <section id="locations-section">
      <h2>Entdecke interessante Orte</h2>
      <div id="locations-container">
        <!-- Hier werden die Locations dynamisch eingefügt -->
      </div>
    </section>

    <div id="homepage_footer"></div>

    <script src="./assets/js/fetches.js"></script>
    <script src="./assets/js/gallery.js"></script>
    <script>
document.addEventListener('DOMContentLoaded', async function() {
    try {
        // Locations von der API holen
        const response = await fetch('./api/home.php');
        const data = await response.json();
        
        if (data.code === 200 && data.locations && data.locations.length > 0) {
            const container = document.getElementById('locations-container') || document.createElement('div');
            container.id = 'locations-container';
            
            if (!container.parentElement) {
                document.querySelector('main') ? document.querySelector('main').appendChild(container) : document.body.appendChild(container);
            }
            
            // Container leeren
            container.innerHTML = '';
            
            // Für jede Location eine Karte erstellen
            data.locations.forEach(location => {
                const card = document.createElement('div');
                card.className = 'location-card';
                card.setAttribute('data-id', location.id);
                
                card.innerHTML = `
                    <div class="location-content">
                        <h3>${location.name}</h3>
                        <p class="location-description">${location.description || ''}</p>
                        <div class="card-actions">
                            <a href="./pages/location/location.html?id=${location.id}" class="location-details-btn">Details</a>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            // Gallery-Funktionen initialisieren
            setupGalleries();
        }
    } catch (error) {
        console.error('Fehler beim Laden der Locations:', error);
    }
});
</script>
  </body>
</html>
